<div xmlns:th="http://www.thymeleaf.org" th:fragment="content">
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <div class="max-w-3xl mx-auto px-4 py-8">
    <h1 th:text="${isEdit} ? 'Chỉnh sửa đơn hàng' : 'Tạo đơn hàng'" class="text-2xl font-bold mb-6 text-blue-700"></h1>

<form th:action="@{${isEdit} ? '/admin/fragment/orders/edit/' + ${order.orderId} : '/admin/fragment/orders/create'}"
      th:object="${order}"
      method="post"
      th:attr="hx-post=@{${isEdit} ? '/admin/fragment/orders/edit/' + ${order.orderId} : '/admin/fragment/orders/create'}"
      hx-target="#section-content"
      hx-swap="innerHTML"
      class="space-y-4 bg-white p-6 rounded-lg shadow">

      <!-- Thông tin khách hàng -->
      <div>
        <label class="block mb-1 font-medium">Khách hàng</label>
        <select name="userId" class="w-full border border-gray-300 rounded px-3 py-2">
          <option th:each="u : ${users}"
                  th:value="${u.userId}"
                  th:selected="${order.user != null && u.userId == order.user.userId}"
                  th:text="${u.fullName}"></option>
        </select>
      </div>

      <!-- Địa chỉ giao hàng -->
      <div>
        <label class="block mb-1 font-medium">Địa chỉ giao hàng</label>
        <input type="text" th:field="*{shippingAddress}" class="w-full border border-gray-300 rounded px-3 py-2" required />
      </div>

      <!-- Tổng tiền -->
      <div>
        <label class="block mb-1 font-medium">Tổng tiền</label>
        <input type="number" step="0.01" th:field="*{totalAmount}" class="w-full border border-gray-300 rounded px-3 py-2" required />
      </div>

      <!-- Trạng thái đơn hàng -->
      <div>
        <label class="block mb-1 font-medium">Trạng thái</label>
        <select th:field="*{status}" class="w-full border border-gray-300 rounded px-3 py-2">
          <option value="PENDING">Đang chờ xử lý</option>
          <option value="CONFIRMED">Đã xác nhận</option>
          <option value="SHIPPED">Đã giao hàng</option>
          <option value="COMPLETED">Hoàn thành</option>
          <option value="CANCELLED">Đã hủy</option>
        </select>
      </div>

      <!-- Thanh toán -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block mb-1 font-medium">Phương thức TT</label>
          <select th:field="*{paymentMethod}" class="w-full border border-gray-300 rounded px-3 py-2">
            <option value="COD">Thanh toán khi nhận hàng (COD)</option>
            <option value="BANK">Chuyển khoản ngân hàng</option>
            <option value="MOMO">Ví MoMo</option>
            <option value="VNPAY">VNPay</option>
          </select>
        </div>
        <div>
          <label class="block mb-1 font-medium">Trạng thái TT</label>
          <select th:field="*{paymentStatus}" class="w-full border border-gray-300 rounded px-3 py-2">
            <option value="PENDING">Đang chờ thanh toán</option>
            <option value="SUCCESS">Thanh toán thành công</option>
            <option value="FAILED">Thanh toán thất bại</option>
            <option value="REFUNDED">Đã hoàn tiền</option>
          </select>
        </div>
      </div>

      <!-- Ghi chú -->
      <div>
        <label class="block mb-1 font-medium">Ghi chú</label>
        <textarea th:field="*{note}" rows="3" class="w-full border border-gray-300 rounded px-3 py-2"></textarea>
      </div>

      <div class="flex gap-3">
        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
          <span th:text="${isEdit} ? 'Cập nhật' : 'Tạo mới'"></span>
        </button>
        <button type="button" onclick="history.back()" class="px-4 py-2 border rounded">Huỷ</button>
      </div>
    </form>
  </div>
</div>